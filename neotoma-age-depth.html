<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Quinn Asena">
<meta name="author" content="Jack Williams">
<meta name="dcterms.date" content="2025-11-29">

<title>Neotoma age-depth</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="neotoma-age-depth_files/libs/clipboard/clipboard.min.js"></script>
<script src="neotoma-age-depth_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="neotoma-age-depth_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="neotoma-age-depth_files/libs/quarto-html/popper.min.js"></script>
<script src="neotoma-age-depth_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="neotoma-age-depth_files/libs/quarto-html/anchor.min.js"></script>
<link href="neotoma-age-depth_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="neotoma-age-depth_files/libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="neotoma-age-depth_files/libs/quarto-html/quarto-syntax-highlighting-dark-2b3e328b71be8d25427581baeb23079b.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="neotoma-age-depth_files/libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="neotoma-age-depth_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="neotoma-age-depth_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="neotoma-age-depth_files/libs/bootstrap/bootstrap-6e5ff12f349f7d7ee99023e5a7f49be9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="neotoma-age-depth_files/libs/bootstrap/bootstrap-dark-1c59215f878e034bd7426c637fa661ac.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="neotoma-age-depth_files/libs/bootstrap/bootstrap-6e5ff12f349f7d7ee99023e5a7f49be9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-age-depth" id="toc-sec-age-depth" class="nav-link active" data-scroll-target="#sec-age-depth">Background</a>
  <ul class="collapse">
  <li><a href="#sec-cal-curve" id="toc-sec-cal-curve" class="nav-link" data-scroll-target="#sec-cal-curve">Radiocarbon callibration and uncertainty</a></li>
  </ul></li>
  <li><a href="#calibrating-radiocarbon-dates-in-r" id="toc-calibrating-radiocarbon-dates-in-r" class="nav-link" data-scroll-target="#calibrating-radiocarbon-dates-in-r">Calibrating radiocarbon dates in R</a>
  <ul class="collapse">
  <li><a href="#your-turn" id="toc-your-turn" class="nav-link" data-scroll-target="#your-turn">Your turn</a></li>
  </ul></li>
  <li><a href="#types-of-age-depth-models" id="toc-types-of-age-depth-models" class="nav-link" data-scroll-target="#types-of-age-depth-models">Types of Age-Depth Models</a>
  <ul class="collapse">
  <li><a href="#classical-age-depth-models" id="toc-classical-age-depth-models" class="nav-link" data-scroll-target="#classical-age-depth-models">Classical age-depth models</a></li>
  </ul></li>
  <li><a href="#bayesian-age-depth-models" id="toc-bayesian-age-depth-models" class="nav-link" data-scroll-target="#bayesian-age-depth-models">Bayesian age-depth models</a>
  <ul class="collapse">
  <li><a href="#your-turn-1" id="toc-your-turn-1" class="nav-link" data-scroll-target="#your-turn-1">Your turn</a></li>
  </ul></li>
  <li><a href="#neotoma" id="toc-neotoma" class="nav-link" data-scroll-target="#neotoma">Neotoma</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Neotoma age-depth</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Quinn Asena </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Cary Institute for ecosystem Sciences
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Jack Williams </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of Wisconsin-Madison
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 29, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="sec-age-depth" class="level1">
<h1>Background</h1>
<p>For the last 50,000 years, radiocarbon (<sup>14</sup>C), with its half-life of 5,730 years, is by far the most common form of radiometric dating. (Beyond 10 half-lives, so much of a radioactive substance has decayed away that it becomes immeasurable.) Radiocarbon is the mainstay of Quaternary dating and archaeology.</p>
<p>In Quaternary paleoecology, radiocarbon dating is expensive – a single sample typically costs $300 to $500 – so usually a given lake-sediment record will have only a scattering (ca. 5 to 30) of radiocarbon dates and other age controls. Other kinds of age controls include volcanic ash layers (tephras), <sup>210</sup>Pb (half-life: 22.6 yrs), optically stimulated luminescence (OSL) dates, historic events such as the rise in <em>Ambrosia</em> pollen abundances associated with EuroAmerican land clearance, etc. An age-depth model must be constructed to estimate the age of sediments not directly associated with an age control. In multi-site data syntheses, the number of age controls, their precision, and their likely accuracy are all fundamental indicators of data quality <span class="citation" data-cites="blois2011 mottl2021">(e.g. <a href="#ref-blois2011" role="doc-biblioref">Blois et al. 2011</a>; <a href="#ref-mottl2021" role="doc-biblioref">Mottl et al. 2021</a>)</span>.</p>
<p>To estimate ages for depths lacking radiocarbon date, an age-depth model is required. Age-depth models are fitted to the available age controls (age estimates with uncertainty for individual depths) and provide estimates of age as a function of depth, for all depths and ages within the temporal bounds of the model.</p>
<p>Here we will gain practice in working with age-depth models of various kind, and assessing their age estimates and uncertainty. We’ll begin with a bit of practice in calibrating radiocarbon years to calendar years and comparing the resulting age estimates from different calibration curves.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Packages required
</div>
</div>
<div class="callout-body-container callout-body">
<p>We will be using <code>Bchron</code> for calibration and Bayesian age-depth modelling. Notably <code>rbacon</code> is another commonly used package, see <span class="citation" data-cites="trachsel2017">Trachsel and Telford (<a href="#ref-trachsel2017" role="doc-biblioref">2017</a>)</span> for a discussion on age-depth models. We will also be fitting some interpolation and linear models using BASE-R. Remember you must have packages both installed <em>and</em> loaded, often loading a package is done via the <code>library(packagename)</code> function. The following code using the <code>pacman</code> package takes care of installation and loading in one go.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load up the package</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"pacman"</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>, <span class="at">repos=</span><span class="st">"http://cran.r-project.org"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(neotoma2, Bchron, splines) <span class="co"># splines comes with BASE-R</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<section id="sec-cal-curve" class="level2">
<h2 class="anchored" data-anchor-id="sec-cal-curve">Radiocarbon callibration and uncertainty</h2>
<p>A complication in radiocarbon dating is that the initial calculation of a radiocarbon age assumes, by convention, that the amount of radiocarbon in the atmosphere is constant over time. See <span class="citation" data-cites="ramsey2008">Ramsey (<a href="#ref-ramsey2008" role="doc-biblioref">2008</a>)</span> for a good overview of <sup>14</sup>C dating. This assumption is untrue, so all radiocarbon age estimates must be post-hoc calibrated using a calibration curve that is based on compiling radiocarbon dates of materials that have precise independent age estimates (e.g.&nbsp;tree rings, corals). Yet another complication in radiocarbon dating is that different calibration curves need to be used for the Northern vs.&nbsp;Southern Hemisphere and for the atmosphere vs.&nbsp;oceans, due to different residence times of <sup>14</sup>C in these different reservoirs. For example, atmospheric radiocarbon that diffuses into the surface oceans usually will reside for centuries before phytoplankton biologically fix it through photosynthesis, which will lead marine <sup>14</sup>C to be depleted (and ‘too old’) relative to atmospheric <sup>14</sup>C. Use the wrong calibration curve and your age estimate will be inaccurate!</p>
<p>The IntCal series (IntCal04, IntCal09, IntCal13, IntCal20) is the community standard for calibrating radiocarbon dates to age estimates in calendar years in the northern hemisphere <span class="citation" data-cites="reimer2020">(e.g., <a href="#ref-reimer2020" role="doc-biblioref">Reimer et al. 2020</a>)</span>. The SHcal series is used for the southern hemisphere. The conversion from radiocarbon to calendar years usually further increases the uncertainty of age estimates.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BchronCalibrate</span>(<span class="at">ages=</span><span class="fu">c</span>(<span class="dv">11553</span>), </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">ageSds=</span><span class="fu">c</span>(<span class="dv">50</span>), </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">calCurves=</span><span class="fu">c</span>(<span class="st">'intcal20'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">includeCal =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="neotoma-age-depth_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="calibrating-radiocarbon-dates-in-r" class="level1">
<h1>Calibrating radiocarbon dates in R</h1>
<p>Here we’ll experiment with calibrating radiocarbon dates, using various calibration curves. Radiocarbon dated samples come back from the lab with a radiocarbon age and standard deviation, among other information. These two bits of information are used to calibrate the radiocarbon dates to estimated ages. R packages may have useful vignettes (package tutorials) and built-in datasets that provide handy test templates. The following code is modified from the <code>Bchron</code> <a href="https://cran.r-project.org/web/packages/Bchron/vignettes/Bchron.html">vignette</a>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Summary</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Plots</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false" href="">Calibration curve plots</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">=</span> <span class="fu">BchronCalibrate</span>(<span class="at">ages=</span><span class="fu">c</span>(<span class="dv">3445</span>,<span class="dv">11553</span>,<span class="dv">7456</span>), </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ageSds=</span><span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">230</span>,<span class="dv">110</span>), </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">calCurves=</span><span class="fu">c</span>(<span class="st">'intcal20'</span>,<span class="st">'intcal20'</span>,<span class="st">'intcal20'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% Highest density regions for Date1
$`94.4%`
[1] 3572 3834


95% Highest density regions for Date2
$`0.4%`
[1] 13004 13025

$`77.9%`
[1] 13059 13874

$`16.4%`
[1] 13923 14012


95% Highest density regions for Date3
$`94.6%`
[1] 8022 8423</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="neotoma-age-depth_files/figure-html/BchronCalibratePlot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="neotoma-age-depth_files/figure-html/BchronCalibratePlot-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="neotoma-age-depth_files/figure-html/BchronCalibratePlot-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ages, <span class="at">includeCal =</span> <span class="cn">TRUE</span>, <span class="at">fillCol =</span> <span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`height` was translated to `width`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="neotoma-age-depth_files/figure-html/BchronCalibrateCalPlot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>The output summary indicates the range of the highest density regions (i.e., the most likely ‘real’ age range of the sample). The <code>plot</code> function in <code>Bchron</code> outputs a <code>ggplot</code> object of the high density regions of the most likely ages.</p>
<section id="your-turn" class="level2">
<h2 class="anchored" data-anchor-id="your-turn">Your turn</h2>
<p>The <code>BchronCalibrate()</code> example above uses three arguments: (i) uncalibrated ages (the estimated date returned from the lab); (ii) a standard deviation associated with each of the ages; (iii) a calibration curve associated with each of the dates. Take 5 minutes to:</p>
<ul>
<li>Experiment with calibrating a few different ages and standard deviations
<ul>
<li>try a few single ages and plot the calibration curve as shown in <a href="#sec-cal-curve" class="quarto-xref">Section&nbsp;1.1</a></li>
</ul></li>
<li>check the function documentation for different calibration curves and try the southern hemisphere calibration.</li>
</ul>
<p>Give a <span class="emoji" data-emoji="raised_hand">✋</span> in zoom if you have questions and <span class="emoji" data-emoji="white_check_mark">✅</span> when you have managed to calibrate and inspect a few different dates.</p>
<p>We will go through a couple of examples together.</p>
</section>
</section>
<section id="types-of-age-depth-models" class="level1">
<h1>Types of Age-Depth Models</h1>
<p>Different kinds of age-depth models exist, each with their own underlying assumptions and behavior. In the list below, #1-4 are classical or traditional forms of age-depth models, but Bayesian models are now the norm. The packages <code>rbacon</code> (usually referred to as ‘bacon’) and <code>Bchron</code> are the current standards for Bayesian age-depth modelling. Before going to bayesian models, we’ll begin with the classics.</p>
<ol type="1">
<li><p><strong>Linear interpolation</strong>, a.k.a. ‘connect the dots,’ in which straight lines are drawn between each depth-adjacent pair of age controls.</p></li>
<li><p><strong>Linear regression</strong> (<span class="math inline">\(y=b0~ + b1x\)</span>; <span class="math inline">\(y=\)</span>time and <span class="math inline">\(x=\)</span>depth; <span class="math inline">\(b0\)</span> and <span class="math inline">\(b1\)</span> are constants), in which a single straight line is fitted through the entire set of age controls. In ordinary linear regression (OLS), the chosen line will minimize the y-dimension distances of individual points to the line. Standard OLS assumes that all observations are normally distributed, which is a poor assumption for calibrated radiocarbon dates.</p></li>
<li><p><strong>Polynomials</strong>, also fitted to the entire set of age controls (<span class="math inline">\(y= b0 + b1x + b2x^2 + b3x^3 + …bnx^n\)</span>), are an extension of linear regression, with additional terms for <span class="math inline">\(x^2\)</span>, <span class="math inline">\(x^3\)</span>, etc. Some arbitrary maximum n is chosen, usually in the range of 3 to 5. These are called ‘third-order polynomials,’ ‘fifth-order polynomials,’ etc.</p></li>
<li><p><strong>Splines</strong>, which are a special kind of polynomial function that are locally fitted to subsets of the age controls, and then smoothly interpolated between points. (Several different formulas can be used to generate splines; common forms include cubic, smooth, monotonic, and LOWESS).</p></li>
<li><p><strong>Bayesian age models</strong> (e.g.&nbsp;<code>bacon</code>, <code>bchron</code>, <code>oxcal</code>, etc.). Bayesian models differ in detail, but all combine a statistical representation of prior knowledge with the new data (i.e.&nbsp;the age controls at a site) to build an age-depth model with posterior estimates of age for any given depth. Bayesian models are now widely used because:</p>
<ol type="i">
<li>they allow the incorporation of prior knowledge (e.g., from coring many lakes, we now have decent estimates of typical sediment accumulation rates, <span class="citation" data-cites="goring2012">Goring et al. (<a href="#ref-goring2012" role="doc-biblioref">2012</a>)</span>);</li>
<li>they can handle highly irregular probability distribution functions such as those for radiocarbon dates after calibration; and as a result</li>
<li>they generally do a better job of describing uncertainty than traditional age-depth models.</li>
</ol></li>
</ol>
<section id="classical-age-depth-models" class="level2">
<h2 class="anchored" data-anchor-id="classical-age-depth-models">Classical age-depth models</h2>
<p>Classical models are now out-dated methods <span class="citation" data-cites="blaauw2018">(<a href="#ref-blaauw2018" role="doc-biblioref">Blaauw et al. 2018</a>)</span>, but it is useful to understand how they work as literature before the relatively recent development of Bayesian methods has relied on them. Let’s explore some classical methods of age-depth modelling using one of the datasets included with the <code>Bchron</code> package. The data are from a core in Northern Ireland; Sluggan Bog <span class="citation" data-cites="smith1991">Smith and Goddard (<a href="#ref-smith1991" role="doc-biblioref">1991</a>)</span>, and can be called via:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Sluggan) <span class="co"># Call the data from Bchron</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Sluggan) <span class="co"># Check out the data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Linear interpolation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Linear regression</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false" href="">Polynomial regression</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false" href="">Cubic splines</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Linear interpolation predicts ages by simply, drawing a line between successive dated samples. This method assumes that there is a constant age-depth relationship between samples. An assumption that is unlikely to be true, especially of cores with fewer dated samples than Sluggan Moss.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>interp_ages <span class="ot">&lt;-</span> <span class="fu">approx</span>(<span class="at">x =</span> Sluggan<span class="sc">$</span>ages, <span class="at">y =</span> Sluggan<span class="sc">$</span>position) <span class="co"># use the function approx() to interpolate between ages</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> interp_ages<span class="sc">$</span>x, <span class="at">y =</span> interp_ages<span class="sc">$</span>y, <span class="at">type =</span> <span class="st">'l'</span>) <span class="co"># Plot the interpolated data</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> Sluggan<span class="sc">$</span>ages, <span class="at">y =</span> Sluggan<span class="sc">$</span>position, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">'red'</span>) <span class="co"># overlay the original age points</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="neotoma-age-depth_files/figure-html/LinearInterp-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Linear regression provides a line of best fit through the dated samples. This method assumes a constant age-depth relationship across all samples, also unlikely to be true depending on processes affecting the core during its formation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mod_ages <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sluggan<span class="sc">$</span>position <span class="sc">~</span> Sluggan<span class="sc">$</span>ages) <span class="co"># Create a linear regression model</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> Sluggan<span class="sc">$</span>ages, <span class="at">y =</span> Sluggan<span class="sc">$</span>position, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">'red'</span>) <span class="co"># Plot the original ages</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mod_ages) <span class="co"># add the regression line from the regression model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="neotoma-age-depth_files/figure-html/LinearReg-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>Polynomial regression allows a curve to be fit through the data. The amount the curve ‘wiggles’ depends on the order of the polynomial fit to the data. Polynomial regression has the risk of being over-fit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> Sluggan<span class="sc">$</span>ages <span class="co"># Renaming the variables because the predict function below is fussy about the input name</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> Sluggan<span class="sc">$</span>position</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>poly_ages <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">3</span>))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> Sluggan<span class="sc">$</span>ages, <span class="at">y =</span> Sluggan<span class="sc">$</span>position, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">'red'</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>age_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">range</span>(Sluggan<span class="sc">$</span>ages)[<span class="dv">1</span>], <span class="at">to =</span> <span class="fu">range</span>(Sluggan<span class="sc">$</span>ages)[<span class="dv">2</span>], <span class="at">length.out =</span> <span class="dv">250</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(age_range, <span class="fu">predict</span>(poly_ages, <span class="fu">data.frame</span>(<span class="at">x =</span> age_range)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="neotoma-age-depth_files/figure-html/PolyReg-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<p>Splines are a class of functions including, for example, smoothing splines or cubic splines. Cubic splines are pieve-wise polynomials locally between ‘knots’. That is the data are split into bins that are fit independently using. By default, the <code>bs()</code> function uses a third degree polynomial. Without providing knots the fit will look the same as a third degree polynomial regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>cubic_ages <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">bs</span>(x, <span class="at">knots =</span> <span class="fu">c</span>(<span class="dv">1000</span>, <span class="dv">6000</span>, <span class="dv">12000</span>)))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> Sluggan<span class="sc">$</span>ages, <span class="at">y =</span> Sluggan<span class="sc">$</span>position, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">'red'</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(age_range, <span class="fu">predict</span>(cubic_ages, <span class="fu">data.frame</span>(<span class="at">x =</span> age_range)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="neotoma-age-depth_files/figure-html/CubicSpline-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Because classical age-depth modelling is rarely used now we are not going to delve further into the statistical details of the best way of fitting each model (e.g., the number of knots to use for fitting a cubic spline).</p>
<p>One of the issues with classical age-depth modelling is that uncertainty <em>decreases</em> with fewer datapoints.</p>
</section>
</section>
<section id="bayesian-age-depth-models" class="level1">
<h1>Bayesian age-depth models</h1>
<p>Now let’s see what the latest methods show for the same dataset.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Summary</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false" href="">Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Note that all the values provided to the arguments are contained in the Sluggan dataframe. When creating chronologies from your own (or accessed data), you may need to rename them to match your data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>SlugganOut <span class="ot">=</span> <span class="fu">with</span>(Sluggan, </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>               <span class="fu">Bchronology</span>(<span class="at">ages=</span>ages,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ageSds=</span>ageSds, </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">calCurves=</span>calCurves,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">positions=</span>position, </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">positionThicknesses=</span>thickness,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ids=</span>id, </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">predictPositions=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">518</span>, <span class="at">by=</span><span class="dv">10</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>The summary shows for each position (depth) the median and quartiles of the predicted ages for that position.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SlugganOut)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Quantiles of predicted ages by depth: 
 Depth      2.5%      25%     50%      75%     97.5%
     0   -60.000    95.75   253.5   450.25   730.000
    10    29.875   246.50   409.0   569.25   789.050
    20   141.950   379.75   536.5   670.75   830.075
    30   271.900   540.00   671.0   762.50   879.000
    40   501.700   723.25   795.0   859.00   928.025
    50   963.975  1071.75  1131.0  1199.25  1333.025
    60  1148.875  1269.00  1334.0  1399.00  1530.050
    70  1401.975  1495.00  1551.0  1616.00  1756.075
    80  1514.000  1653.00  1739.0  1831.00  2016.025
    90  1607.950  1811.00  1906.0  1994.25  2159.025
   100  1855.925  2010.75  2076.0  2165.25  2276.025
   110  2166.950  2369.75  2474.0  2609.25  2900.075
   120  2407.950  2721.75  2843.0  2941.00  3129.000
   130  2970.875  3150.75  3262.0  3381.00  3760.100
   140  3115.000  3393.75  3552.5  3727.25  4073.275
   150  3280.925  3649.75  3834.0  3993.25  4252.200
   160  3609.475  3974.00  4124.0  4223.25  4387.200
   170  4207.000  4341.75  4412.5  4492.00  4634.050
   180  4347.900  4490.75  4562.0  4636.25  4760.025
   190  4528.975  4668.75  4740.5  4813.00  4940.000
   200  4601.975  4749.00  4825.0  4896.25  5022.150
   210  4686.950  4825.75  4906.0  4979.25  5099.000
   220  4789.925  4917.00  4987.0  5049.00  5176.000
   230  4897.975  5028.00  5081.5  5146.00  5279.100
   240  5541.000  5638.00  5683.0  5727.00  5865.000
   250  5641.000  5737.00  5787.0  5843.00  5974.025
   260  5707.900  5823.75  5878.5  5933.00  6036.000
   270  5823.825  5940.00  5984.0  6025.00  6122.100
   280  6289.975  6468.75  6606.5  6809.50  7282.475
   290  6516.825  6946.00  7151.5  7310.25  7544.025
   300  7501.000  7623.00  7687.5  7780.00  8092.150
   310  7643.925  7831.00  7963.5  8118.00  8413.225
   320  7789.850  8071.75  8227.0  8368.00  8570.025
   330  8084.700  8401.75  8497.5  8590.00  8769.175
   340  8484.975  8605.00  8689.0  8781.00  8950.000
   350  8550.000  8694.75  8783.0  8876.25  9052.125
   360  8627.000  8794.75  8890.5  8979.00  9139.050
   370  9042.900  9230.00  9299.0  9374.00  9508.250
   380  9157.900  9326.75  9400.0  9474.25  9644.125
   390  9251.000  9400.00  9473.0  9557.00  9756.000
   400  9337.800  9478.75  9562.0  9652.25  9876.125
   410  9499.950  9650.00  9751.0  9878.25 10122.025
   420  9626.625  9844.00  9979.5 10114.25 10272.050
   430  9798.950 10064.75 10255.5 10325.25 10462.000
   440  9942.975 10173.75 10309.0 10385.00 10550.050
   450 10426.925 10590.00 10685.0 10775.00 11027.050
   460 10716.000 10904.75 11022.5 11106.25 11274.050
   470 11148.925 11497.75 11711.5 11938.00 12398.175
   480 11589.900 12193.50 12398.0 12546.50 12701.000
   490 12741.875 12867.75 12925.0 12982.00 13104.075
   500 12910.975 13054.75 13124.0 13192.00 13391.100
   510 13333.975 13506.75 13604.5 13709.00 13889.125</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(SlugganOut)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="neotoma-age-depth_files/figure-html/BayesianPlots-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Median and mean ages
</div>
</div>
<div class="callout-body-container callout-body">
<p>Commonly, only the median age is reported; however, it is good practice to report and consider the range of possible ages, especially when exploring synchroneity of events across space. Notice how <code>Bchron</code> focuses on delivering ranges and densities.</p>
</div>
</div>
<section id="your-turn-1" class="level2">
<h2 class="anchored" data-anchor-id="your-turn-1">Your turn</h2>
<p>The <code>Sluggan</code> data provide a great in-built working dataset for us to play with. Take 5 minutes to:</p>
<ul>
<li>load up the <code>Sluggan</code> dataset (<code>data(Sluggan)</code>)</li>
<li>sample the dataset to reduce the number of rows(<code>Sluggan2 &lt;- Sluggan[c(1, 10, 31), ]</code>)</li>
<li>Run and plot the <code>Bchron</code> age-depth model</li>
</ul>
<p>Give a <span class="emoji" data-emoji="raised_hand">✋</span> in zoom if you have questions and <span class="emoji" data-emoji="white_check_mark">✅</span> when you have managed to calibrate and inspect a few different dates.</p>
<p>Who has a figure they are willing to share?</p>
</section>
</section>
<section id="neotoma" class="level1">
<h1>Neotoma</h1>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Resources
</div>
</div>
<div class="callout-body-container callout-body">
<p>Age-depth modelling is complicated, there are many pitfalls, assumptions, and uncertainties that are often ignored. Recent developments have begun to focus on quantifying uncertainties to understand the reliability of inferences made from the data. Key papers for understanding age depth modelling include:</p>
<ul>
<li><p><span class="citation" data-cites="blaauw2018">Blaauw et al. (<a href="#ref-blaauw2018" role="doc-biblioref">2018</a>)</span></p></li>
<li><p><span class="citation" data-cites="parnell2008">Parnell et al. (<a href="#ref-parnell2008" role="doc-biblioref">2008</a>)</span></p></li>
<li><p><span class="citation" data-cites="trachsel2017">Trachsel and Telford (<a href="#ref-trachsel2017" role="doc-biblioref">2017</a>)</span></p></li>
</ul>
<p>The Bchron <a href="https://cran.r-project.org/web/packages/Bchron/vignettes/Bchron.html">vignette</a> is also a useful resource.</p>
</div>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-blaauw2018" class="csl-entry" role="listitem">
Blaauw, Maarten, J. Andrés Christen, K. D. Bennett, and Paula J. Reimer. 2018. <span>“Double the Dates and Go for <span>Bayes</span> — <span>Impacts</span> of Model Choice, Dating Density and Quality on Chronologies.”</span> <em>Quaternary Science Reviews</em> 188 (May): 58–66. <a href="https://doi.org/10.1016/j.quascirev.2018.03.032">https://doi.org/10.1016/j.quascirev.2018.03.032</a>.
</div>
<div id="ref-blois2011" class="csl-entry" role="listitem">
Blois, Jessica L., John W. (Jack) Williams, Eric C. Grimm, Stephen T. Jackson, and Russell W. Graham. 2011. <span>“A Methodological Framework for Assessing and Reducing Temporal Uncertainty in Paleovegetation Mapping from Late-<span>Quaternary</span> Pollen Records.”</span> <em>Quaternary Science Reviews</em> 30 (15-16): 1926–39. <a href="https://doi.org/10.1016/j.quascirev.2011.04.017">https://doi.org/10.1016/j.quascirev.2011.04.017</a>.
</div>
<div id="ref-goring2012" class="csl-entry" role="listitem">
Goring, S., J. W. Williams, J. L. Blois, S. T. Jackson, C. J. Paciorek, R. K. Booth, J. R. Marlon, M. Blaauw, and J. A. Christen. 2012. <span>“Deposition Times in the Northeastern <span>United States</span> During the <span>Holocene</span>: Establishing Valid Priors for <span>Bayesian</span> Age Models.”</span> <em>Quaternary Science Reviews</em> 48 (August): 54–60. <a href="https://doi.org/10.1016/j.quascirev.2012.05.019">https://doi.org/10.1016/j.quascirev.2012.05.019</a>.
</div>
<div id="ref-mottl2021" class="csl-entry" role="listitem">
Mottl, Ondřej, Suzette G. A. Flantua, Kuber P. Bhatta, Vivian A. Felde, Thomas Giesecke, Simon Goring, Eric C. Grimm, et al. 2021. <span>“Global Acceleration in Rates of Vegetation Change over the Past 18,000 Years.”</span> <em>Science</em> 372 (6544): 860–64. <a href="https://doi.org/10.1126/science.abg1685">https://doi.org/10.1126/science.abg1685</a>.
</div>
<div id="ref-parnell2008" class="csl-entry" role="listitem">
Parnell, A. C., J. Haslett, J. R. M. Allen, C. E. Buck, and B. Huntley. 2008. <span>“A Flexible Approach to Assessing Synchroneity of Past Events Using <span>Bayesian</span> Reconstructions of Sedimentation History.”</span> <em>Quaternary Science Reviews</em> 27 (19-20): 1872–85. <a href="https://doi.org/10.1016/j.quascirev.2008.07.009">https://doi.org/10.1016/j.quascirev.2008.07.009</a>.
</div>
<div id="ref-ramsey2008" class="csl-entry" role="listitem">
Ramsey, C. Bronk. 2008. <span>“Radiocarbon Dating: <span>Revolutions</span> in Understanding.”</span> <em>Archaeometry</em> 50 (2): 249–75. <a href="https://doi.org/10.1111/j.1475-4754.2008.00394.x">https://doi.org/10.1111/j.1475-4754.2008.00394.x</a>.
</div>
<div id="ref-reimer2020" class="csl-entry" role="listitem">
Reimer, Paula J, William E N Austin, Edouard Bard, Alex Bayliss, Paul G Blackwell, Christopher Bronk Ramsey, Martin Butzin, et al. 2020. <span>“The <span>IntCal20 Northern Hemisphere Radiocarbon Age Calibration Curve</span> (0–55 Cal <span class="nocase">kBP</span>).”</span> <em>Radiocarbon</em> 62 (4): 725–57. <a href="https://doi.org/10.1017/RDC.2020.41">https://doi.org/10.1017/RDC.2020.41</a>.
</div>
<div id="ref-smith1991" class="csl-entry" role="listitem">
Smith, A. G., and I. C. Goddard. 1991. <span>“A 12500 <span>Year Record</span> of <span>Vegetational History</span> at <span>Sluggan Bog</span>, <span>Co</span>. <span>Antrim</span>, <span>N</span>. <span>Ireland</span> (<span>Incorporating</span> a <span>Pollen Zone Scheme</span> for the <span>Non-Specialist</span>).”</span> <em>The New Phytologist</em> 118 (1): 167–87. <a href="https://www.jstor.org/stable/2557698">https://www.jstor.org/stable/2557698</a>.
</div>
<div id="ref-trachsel2017" class="csl-entry" role="listitem">
Trachsel, Mathias, and Richard J Telford. 2017. <span>“All Age–Depth Models Are Wrong, but Are Getting Better.”</span> <em>The Holocene</em> 27 (6): 860–69. <a href="https://doi.org/10.1177/0959683616675939">https://doi.org/10.1177/0959683616675939</a>.
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>